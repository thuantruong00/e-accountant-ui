<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-signin-client_id"
        content="562534482065-euo6uusfbalt3lhe2gu39j2e465jna8k.apps.googleusercontent.com">
    <title>E-accountant</title>
</head>

<body>
    <script src="https://accounts.google.com/gsi/client" async defer>
    </script>
    <script>
        let client;
        let token;
        window.onload = function () {

            google.accounts.id.initialize({
                client_id: '562534482065-euo6uusfbalt3lhe2gu39j2e465jna8k.apps.googleusercontent.com',
                callback: handleCallbackInit
            }) 

            google.accounts.id.prompt(res);
            
        }
        function handleCallbackInit(){

        }
        

        async function load() {
            client = google.accounts.oauth2.initCodeClient({
                client_id: '562534482065-euo6uusfbalt3lhe2gu39j2e465jna8k.apps.googleusercontent.com',
                scope: 'https://www.googleapis.com/auth/calendar.readonly',
                ux_mode: 'popup',
                callback: (response) => {
                    const xhr = new XMLHttpRequest();
                    xhr.open('POST', code_receiver_uri, true);
                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                    // Set custom header for CRSF
                    xhr.setRequestHeader('X-Requested-With', 'XmlHttpRequest');
                    xhr.onload = function () {
                        console.log('Auth code response: ' + xhr.responseText);
                    };
                    xhr.send('code=' + response.code);
                },
            });
        }




    </script>
    <!-- <script src="https://accounts.google.com/gsi/client" onload="console.log('TODO: add onload function')">  
    </script> -->

    <!-- 562534482065-euo6uusfbalt3lhe2gu39j2e465jna8k.apps.googleusercontent.com -->

    <!-- <div id="g_id_onload" data-client_id="562534482065-euo6uusfbalt3lhe2gu39j2e465jna8k.apps.googleusercontent.com"
        data-context="signin" data-ux_mode="popup" data-callback="login" data-auto_prompt="false">
    </div>

    <div class="g_id_signin" data-type="standard" data-shape="rectangular" data-theme="outline" data-text="signin_with"
        data-size="large" data-locale="en-US" data-logo_alignment="left">
    </div> -->
    <button onclick="client.requestCode();">Authorize with Google</button>
    <button id="btn">click</button>

</body>

</html>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>

<script>



    $('#btn').click(async function () {
        let data = {
            'client_id': '562534482065-euo6uusfbalt3lhe2gu39j2e465jna8k.apps.googleusercontent.com',
            'redirect_uri': 'http://localhost:5500',
            'response_type': 'token',
            'scope': 'https://www.googleapis.com/auth/drive.metadata.readonly',
            'include_granted_scopes': 'true',
            'state': 'pass-through value'
        }
        $.ajax({
            url: "https://accounts.google.com/o/oauth2/v2/auth",
            type: "GET",
            // headers: { Authorization: "Bearer " + token },
            data: data
        })
            .then(function (e) {
                console.log(e)
            });
    })










    function login(e) {
        console.log("OK")
        // token = e.credential;
        // console.log(e.credential)
        console.log(e)
    }



</script>